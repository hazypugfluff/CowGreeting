#!/bin/bash

set -e

# Create system-wide plugin directory examples
mkdir -p /usr/share/cowgreeting/plugins

# Make the main script executable (already done in packaging, but ensure it's set)
chmod +x /usr/bin/cowgreeting

# Copy example plugin if it doesn't exist
if [ ! -f "/usr/share/cowgreeting/plugins/hello.sh" ]; then
    cat > /usr/share/cowgreeting/plugins/hello.sh << 'EOF'
#!/bin/bash
echo "ðŸŒ„ Hello from the plugin system!"
exit 0
EOF
    chmod +x /usr/share/cowgreeting/plugins/hello.sh
fi

# Update alternatives to make cowgreeting available as 'greetcow' too
update-alternatives --install /usr/bin/greetcow greetcow /usr/bin/cowgreeting 100

#DEBHELPER#

exit 0 